Return-Path: <linux-ext4-owner@vger.kernel.org>
X-Original-To: lists+linux-ext4@lfdr.de
Delivered-To: lists+linux-ext4@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 419563FCA57
	for <lists+linux-ext4@lfdr.de>; Tue, 31 Aug 2021 16:49:43 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S237512AbhHaOug (ORCPT <rfc822;lists+linux-ext4@lfdr.de>);
        Tue, 31 Aug 2021 10:50:36 -0400
Received: from mail-bn8nam11on2087.outbound.protection.outlook.com ([40.107.236.87]:1888
        "EHLO NAM11-BN8-obe.outbound.protection.outlook.com"
        rhost-flags-OK-OK-OK-FAIL) by vger.kernel.org with ESMTP
        id S232214AbhHaOuf (ORCPT <rfc822;linux-ext4@vger.kernel.org>);
        Tue, 31 Aug 2021 10:50:35 -0400
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=MSMc8oB4QGNG9INulmufZTX58KHy8mlaBC1ZIYq5EG4OVNquF/NHYB8cUaVyyEBQRyuLphOvNDhDnIyTqxJpIJij/98yrC3AgSSF04tQFJujFMUsgLYzf64EMZ7VhzejMmdNcWRIt5Tdc1BRkPzCk1/NVukOES8fAV9Em2OBMVwHXKdT956B+6GkXwGkVVIfrTGKM8WeIuZ4WnBzCwzJaE+x+VgiwfXTpMf71CXLv/5igY8V+3sxx5wKsP+wmIeMIplvh31bM8WKkADdqxdnkfFviY98Qv778SM/ooajHXvQCzQs3d/Uk43eTHs6rUtrM9Oe9h/dsIawku7OpIjqmQ==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901; h=From:Date:Subject:Message-ID:Content-Type:MIME-Version;
 bh=xUze9ZSd9GmkxvVRyBCjaBjyGxLBbW1Ns0UzSYyfPik=;
 b=H+CJPT8P57QrX0nMDVwCOzIHUZAHSceEFSmHvbhz8iJbre52jjt+DjJrMZTl1Y61GC1wDVYJooaRMEanoHKeyZ2FfA+7XA27jQyNMdj6Zehf8BcO3ZzcJlQeFjgzHkDvlFoMmt6si5zP2pnC/OuJkKXsiD3laI3sokZF28d8SBe3BZpKubmz7605aUR/D+Er8q/X0kUzFifvn2/dR5t5wmx4RsRCuzi7C2uh+nNBQ6tVeI9wCseg9JNPeTQIMSxm51R+GPR0ixQDwQeF02BtfdY9OszHGVHePtfkpnf1gRqjNC9Lv04FYWw2W6xGF4oOwDXDaVgVubGhiDt50DqL5g==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=whamcloud.com; dmarc=pass action=none
 header.from=whamcloud.com; dkim=pass header.d=whamcloud.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=whamcloud.com;
 s=selector2;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=xUze9ZSd9GmkxvVRyBCjaBjyGxLBbW1Ns0UzSYyfPik=;
 b=H01ltyBpVdXACqw42JVB4h29noqUyy5sqJl8Jp+R0btURWGhoLhJ/PMN5Cu0CXhYQ95CaTVVYRFwGilct0TiOAbwekF0KaadSI/qSygJipU+y1jONQkHiykTfSJgHEodacSgkrEM71bikl65CZhY2+JrfW6Y8aCH44GfmEfi61w=
Received: from DM8PR19MB5270.namprd19.prod.outlook.com (2603:10b6:8:4::19) by
 DM8PR19MB5287.namprd19.prod.outlook.com (2603:10b6:8:d::8) with Microsoft
 SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id
 15.20.4478.17; Tue, 31 Aug 2021 14:49:36 +0000
Received: from DM8PR19MB5270.namprd19.prod.outlook.com
 ([fe80::f5e6:3426:769c:e207]) by DM8PR19MB5270.namprd19.prod.outlook.com
 ([fe80::f5e6:3426:769c:e207%4]) with mapi id 15.20.4457.024; Tue, 31 Aug 2021
 14:49:36 +0000
From:   Alex Zhuravlev <azhuravlev@whamcloud.com>
To:     linux-ext4 <linux-ext4@vger.kernel.org>
Subject: [RFC] replace revoke hash table with rhashtable
Thread-Topic: [RFC] replace revoke hash table with rhashtable
Thread-Index: AQHXnndq+6k2arjPM0m5NXkxu5vjaQ==
Date:   Tue, 31 Aug 2021 14:49:36 +0000
Message-ID: <96FE09AA-171C-49B1-B434-505C15FEB435@whamcloud.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
authentication-results: vger.kernel.org; dkim=none (message not signed)
 header.d=none;vger.kernel.org; dmarc=none action=none
 header.from=whamcloud.com;
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: aaa16ba5-2712-414c-e303-08d96c8e8d55
x-ms-traffictypediagnostic: DM8PR19MB5287:
x-microsoft-antispam-prvs: <DM8PR19MB528773DFA4719676A1EF001DCBCC9@DM8PR19MB5287.namprd19.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:466;
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: ezF4A8O1McXe7bZkOzZOdzCGAeHiAayEU2qLAAddi0iFDA5doPeG9MZVayy+i9fwpDIjecHm0fqaSQdIYVt5gPAUL6szy5wqasnqZ41APTDCCYOGjaSFMoPQvRI1C/2Iz7kqX2EFbotaJAyYnPRG4nCJcSKRiE99+qp012EjSZpFr49aQCWVCpy3BC9uvf7v5xZugoNIlJzlrsf7y+v7NL5gMkQ6wVYmv4OOqRQF0eAohTYbMJGU+7J30bATVlXH2XbDDSdTYw+ETrNFr0uCD7mDDW/3a+u6FkOadPPykhcQcfC2yIcQCJI8aqYQsy9GMR37dB8N+Hqk3sN9Fbb3+RLpZbW0y+NNMhLpRd2Ng+GNAzbv0mqZtP2I8XJzQ6/JQUfBbMzRkbrHpMyMj5TTAZXFm1OiPhjKdEX6/DLdMwwa0x0nlPVvl9Dbsf89F44sy2FgAXTljYwrtA7KWBYy0cZ2S5eVPvxekGqSiGx5mukutN9IcWR8TJjPDNiQlnK2GM761Koo5Crv/LcEUdocDTnEU+nrCtrW2nsqNN4ykH7waKNrvkomXFP3GU19kJ0emOVf0HTFH/iEbCtfWwM5XNJEV8dh3DS7tFv/iAKZBySsj4gGXgMfIZICqFQ0Jxf2S6CnjcWYlxCr8QbTuB/XgFmYeyQ94hvs1kqHCFxVV5fLvFSQyrHdK0+VZoJJmfQri1u7ER85A3hDUH8ztqPh2vkoqS0Te+jeVDdnPmj9VroQ32s+pqj7J7TqM1DhmIHO
x-forefront-antispam-report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:DM8PR19MB5270.namprd19.prod.outlook.com;PTR:;CAT:NONE;SFS:(4636009)(366004)(136003)(346002)(396003)(376002)(39850400004)(6506007)(53546011)(76116006)(86362001)(91956017)(30864003)(186003)(316002)(26005)(83380400001)(6916009)(2616005)(33656002)(38070700005)(8936002)(5660300002)(38100700002)(8676002)(36756003)(66446008)(2906002)(64756008)(66556008)(122000001)(66476007)(71200400001)(478600001)(6486002)(66946007)(6512007)(21314003)(45980500001);DIR:OUT;SFP:1101;
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?utf-8?B?MkNtalJDWjhpVS85M3hqUzdwQmlFaisxRzdpWFM3SUxtSmozdk1RNzVLbzN2?=
 =?utf-8?B?anRwcFJxQmtwQWd6ZnAwK3RkOEVTczAwVkQramJjRktUbGJrMU8vT0piYkNy?=
 =?utf-8?B?TXljeEp0NGdYbDRJd242NGEyeHYzNW05REhGT1pibmlqNlhCZHlpQWQvN21t?=
 =?utf-8?B?UjJNc3hyT1ZzdzZQTEp2RSt2bFMxN2ZzYjlSUjVUdDJJL0dicHVxWi9TSmsv?=
 =?utf-8?B?M3pLcm9ZdjhDVk5ZL0RoYUxXSFlDUHRiVE4wMTZpZnJVbWdJd2ZiNHdJaEh5?=
 =?utf-8?B?QWtDdTBJcUR2eXJtc3RkdG4rdzRlMW5MS2ovcGdvYjhnOVpMc2lVbngyOXpj?=
 =?utf-8?B?My9qYTREaVk1cTNGdGdiSjVzOUc4UzdQUjZPWDN0V2xpNzJrWnFKbmNjbWRM?=
 =?utf-8?B?SWFPOERoTGkrT2JPSFZDQjkwemV6emh0ZGlYSmNxQk1peGFjODRwVC9xd0p0?=
 =?utf-8?B?OVIvdStjTXM0UGhCNGtTckh4TkhkWEFFUlQzR2RXemx2SnNOc1ZJQVRPbGZu?=
 =?utf-8?B?Yk9JeEVsK05HVGNWaXV3M0NlS1VXdlBsNkxrRWxqSUtSNWR1MFBxM3d2Y3pR?=
 =?utf-8?B?U1EwRHM2TVpjcldMekUzdXlQRXhxWldxaW1hQmFEb3ZMc1o3blEyVGhMd040?=
 =?utf-8?B?cWUwU21Od2JwSk93aDVpN1lVYmxjZStVUncyeUE0OFBYSHJ0Y2cybjU3WlN5?=
 =?utf-8?B?Yk1ZOFM2eXhaSGp3TWZZSzFyYm9HSWdIaUxFWmVzQTc3T3ZydTRQRzAvczBY?=
 =?utf-8?B?WFA5LzlEOVhOczRyUDlPWTNKSVVEdDdCdGhvemRFYm1zc3FGTmFKVi84WERL?=
 =?utf-8?B?c2g1ZkNudmN6S2RDL3YwWUdEdVJBVFphUUdOY3JmekZaS2FJWTRqWUx3UDBT?=
 =?utf-8?B?c3Z2aXBPZHVWblExZnI0Y0Fvakh5d0pOWkxXRUZFSjI5Y0lBOWVTcGs2d3FX?=
 =?utf-8?B?VGhVL1Q1YlBiVUtNeEJTN3hnd2NtQlJrMkI5MEFsQXNBK2ZNWktWVTFoWkwv?=
 =?utf-8?B?MysxZElmOG5FWVhNUE5DcWw4ekxrLzhMSWJISXdkVzcrT2s0bkxudWlPRUZG?=
 =?utf-8?B?djk1MVY4SDNTb1dtOXdOd1M1bnJCTUVJOUZQVG9WelYva2x0QTBQV3ArVXdX?=
 =?utf-8?B?L2RKcW1zRmhEbFpUaHhrV2swNjBVZU5YajNEa3NDK2hGK3BCaDVIdUp5ZFZL?=
 =?utf-8?B?L01Cb0t5RWYzWURwT2NoTEEzNWk2U2ZJU3NleFI2OUgzZkdoTmdtdytqWmg2?=
 =?utf-8?B?elBLMVdHdmdvMzlPRllDUEUrSmxjYzFHUlNoVUQ1Y0xIakUvdzJWTXhtb05K?=
 =?utf-8?B?Rzh1ZUJ6Q1pIaTljK3lHRExCUk9NQlV2TGNLM01lNnlNeE5xeDZYa3I4QjNK?=
 =?utf-8?B?SnRra29heE43Vks3clF5Ti9FeHE2NlJLUzk3SDBNVXhsOXo0bGFPYXFZTmww?=
 =?utf-8?B?b2JHZ3RsM1VTYlRTVHFYZkUya3VEWHJIalNEM0tVemtSdUQyWmZyMGVLZDRD?=
 =?utf-8?B?S2h6VG50dm16VkFhVnBWd3phVmRKV1RRUDBSbHNXa2RnYUorWUxCVFNtcEh4?=
 =?utf-8?B?RGxpNmtRUkU1TUhDOVNmM2NlWjI0bVlJSXhvSUM2KzlRQjcvUGwyaVNGOEFD?=
 =?utf-8?B?eWZjckUweWhDR1E3VDc3SG8yUGFiWXo2UkVFV25LUG5CcnpQWGVQdC9TZ3cz?=
 =?utf-8?B?V0pvcTM5djB3VjJWU1F1eG1MSzZBNFRSdENSaTgzclhsU2tWRXdaSXZMVkEv?=
 =?utf-8?Q?BNQ4s9VHteFtcCWB5lBQpn+QzTsWnvgSaVV3F5Z?=
x-ms-exchange-transport-forked: True
Content-Type: text/plain; charset="utf-8"
Content-ID: <C377B1B19CD7D745B27AA76F3C1F70BF@namprd19.prod.outlook.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: whamcloud.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: DM8PR19MB5270.namprd19.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: aaa16ba5-2712-414c-e303-08d96c8e8d55
X-MS-Exchange-CrossTenant-originalarrivaltime: 31 Aug 2021 14:49:36.0713
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 753b6e26-6fd3-43e6-8248-3f1735d59bb4
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: HeUQ1BvWnAmt2OwvRUzqrvunZ/1mz/shRLEdaQtDzfIt9Xw82iDtS9IVHhX7R/jhhdGGkyLm5+C5qjV5Vx+7og==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: DM8PR19MB5287
Precedence: bulk
List-ID: <linux-ext4.vger.kernel.org>
X-Mailing-List: linux-ext4@vger.kernel.org

SGksDQoNCk5vdCBzbyBsb25nIGFnbyB3ZSBub3RpY2VkIHRoYXQgam91cm5hbCByZXBsYXkgY2Fu
IHRha2UgcXVpdGUgYSBsb3QgKGhvdXJzKSBpbiBjYXNlcyB3aGVyZSBtYW55IGpvdXJuYWxlZCBi
bG9ja3Mgd2VyZSBmcmVlZCBkdXJpbmcgYSBzaG9ydCBwZXJpb2QuDQpJIGJlbmNobWFya2VkIGhh
c2ggdGFibGUgdXNlZCBieSByZXZva2UgY29kZSwgYmFzaWNhbGx5IGl04oCZcyBsb29rdXAraW5z
ZXJ0IGxpa2UgamJkMiBkb2VzIGF0IHJlcGxheToNCg0KMTA0ODU3NiByZWNvcmRzIC0gOTUgc2Vj
b25kcw0KMjA5NzE1MiByZWNvcmRzIC0gNTgwIHNlY29uZHMNCg0KVGhlbiBJIGJlbmNobWFya2Vk
IHJoYXNodGFibGU6DQoxMDQ4NTc2IHJlY29yZHMgLSAyIHNlY29uZHMNCjIwOTcxNTIgcmVjb3Jk
cyAtIDMgc2Vjb25kcw0KNDE5NDMwNCByZWNvcmRzIC0gNyBzZWNvbmRzDQoNClNvLCBoZXJlIGlz
IGEgcGF0Y2ggcmVwbGFjaW5nIGV4aXN0aW5nIGZpeGVkLXNpemUgaGFzaCB0YWJsZSB3aXRoIHJo
YXNodGFibGUsIHBsZWFzZSBoYXZlIGEgbG9vay4NCg0KVGhhbmtzLCBBbGV4DQoNCg0KRnJvbSA2
NGI5MTYxZGI3ZmVlNGVlYTY2NTgzMzc2NTIyMWQ4YTdlNTkwM2I2IE1vbiBTZXAgMTcgMDA6MDA6
MDAgMjAwMQ0KRnJvbTogQWxleCBaaHVyYXZsZXYgPGJ6enpAd2hhbWNsb3VkLmNvbT4NCkRhdGU6
IFR1ZSwgMzEgQXVnIDIwMjEgMTE6NTM6MDkgKzAzMDANClN1YmplY3Q6IFtQQVRDSF0gamJkMiB0
byByZXBsYWNlIGZpeGVkLXNpemUgcmV2b2tlIGhhc2h0YWJsZSB3aXRoIHJoYXNodGFibGUNCg0K
U2lnbmVkLW9mZi1ieTogQWxleCBaaHVyYXZsZXYgPGJ6enpAd2hhbWNsb3VkLmNvbT4NCi0tLQ0K
ZnMvamJkMi9qb3VybmFsLmMgICAgfCAgIDUgKy0NCmZzL2piZDIvcmV2b2tlLmMgICAgIHwgMjU1
ICsrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCmluY2x1ZGUvbGlu
dXgvamJkMi5oIHwgICA4ICstDQozIGZpbGVzIGNoYW5nZWQsIDkwIGluc2VydGlvbnMoKyksIDE3
OCBkZWxldGlvbnMoLSkNCg0KZGlmZiAtLWdpdCBhL2ZzL2piZDIvam91cm5hbC5jIGIvZnMvamJk
Mi9qb3VybmFsLmMNCmluZGV4IDM1MzAyYmMxOTJlYi4uNmUzYTJjYzlkZmQyIDEwMDY0NA0KLS0t
IGEvZnMvamJkMi9qb3VybmFsLmMNCisrKyBiL2ZzL2piZDIvam91cm5hbC5jDQpAQCAtMTM3MCw3
ICsxMzcwLDcgQEAgc3RhdGljIGpvdXJuYWxfdCAqam91cm5hbF9pbml0X2NvbW1vbihzdHJ1Y3Qg
YmxvY2tfZGV2aWNlICpiZGV2LA0KCWpvdXJuYWwtPmpfZmxhZ3MgPSBKQkQyX0FCT1JUOw0KDQoJ
LyogU2V0IHVwIGEgZGVmYXVsdC1zaXplZCByZXZva2UgdGFibGUgZm9yIHRoZSBuZXcgbW91bnQu
ICovDQotCWVyciA9IGpiZDJfam91cm5hbF9pbml0X3Jldm9rZShqb3VybmFsLCBKT1VSTkFMX1JF
Vk9LRV9ERUZBVUxUX0hBU0gpOw0KKwllcnIgPSBqYmQyX2pvdXJuYWxfaW5pdF9yZXZva2Uoam91
cm5hbCk7DQoJaWYgKGVycikNCgkJZ290byBlcnJfY2xlYW51cDsNCg0KQEAgLTMxMzYsOCArMzEz
Niw2IEBAIHN0YXRpYyBpbnQgX19pbml0IGpvdXJuYWxfaW5pdF9jYWNoZXModm9pZCkNCglpbnQg
cmV0Ow0KDQoJcmV0ID0gamJkMl9qb3VybmFsX2luaXRfcmV2b2tlX3JlY29yZF9jYWNoZSgpOw0K
LQlpZiAocmV0ID09IDApDQotCQlyZXQgPSBqYmQyX2pvdXJuYWxfaW5pdF9yZXZva2VfdGFibGVf
Y2FjaGUoKTsNCglpZiAocmV0ID09IDApDQoJCXJldCA9IGpiZDJfam91cm5hbF9pbml0X2pvdXJu
YWxfaGVhZF9jYWNoZSgpOw0KCWlmIChyZXQgPT0gMCkNCkBAIC0zMTUyLDcgKzMxNTAsNiBAQCBz
dGF0aWMgaW50IF9faW5pdCBqb3VybmFsX2luaXRfY2FjaGVzKHZvaWQpDQpzdGF0aWMgdm9pZCBq
YmQyX2pvdXJuYWxfZGVzdHJveV9jYWNoZXModm9pZCkNCnsNCglqYmQyX2pvdXJuYWxfZGVzdHJv
eV9yZXZva2VfcmVjb3JkX2NhY2hlKCk7DQotCWpiZDJfam91cm5hbF9kZXN0cm95X3Jldm9rZV90
YWJsZV9jYWNoZSgpOw0KCWpiZDJfam91cm5hbF9kZXN0cm95X2pvdXJuYWxfaGVhZF9jYWNoZSgp
Ow0KCWpiZDJfam91cm5hbF9kZXN0cm95X2hhbmRsZV9jYWNoZSgpOw0KCWpiZDJfam91cm5hbF9k
ZXN0cm95X2lub2RlX2NhY2hlKCk7DQpkaWZmIC0tZ2l0IGEvZnMvamJkMi9yZXZva2UuYyBiL2Zz
L2piZDIvcmV2b2tlLmMNCmluZGV4IGZhNjA4Nzg4YjkzZC4uNDUzM2JkNDllODc5IDEwMDY0NA0K
LS0tIGEvZnMvamJkMi9yZXZva2UuYw0KKysrIGIvZnMvamJkMi9yZXZva2UuYw0KQEAgLTkwLDEw
ICs5MCwxMCBAQA0KI2luY2x1ZGUgPGxpbnV4L2Jpby5oPg0KI2luY2x1ZGUgPGxpbnV4L2xvZzIu
aD4NCiNpbmNsdWRlIDxsaW51eC9oYXNoLmg+DQorI2luY2x1ZGUgPGxpbnV4L3JoYXNodGFibGUu
aD4NCiNlbmRpZg0KDQpzdGF0aWMgc3RydWN0IGttZW1fY2FjaGUgKmpiZDJfcmV2b2tlX3JlY29y
ZF9jYWNoZTsNCi1zdGF0aWMgc3RydWN0IGttZW1fY2FjaGUgKmpiZDJfcmV2b2tlX3RhYmxlX2Nh
Y2hlOw0KDQovKiBFYWNoIHJldm9rZSByZWNvcmQgcmVwcmVzZW50cyBvbmUgc2luZ2xlIHJldm9r
ZWQgYmxvY2suICBEdXJpbmcNCiAgIGpvdXJuYWwgcmVwbGF5LCB0aGlzIGludm9sdmVzIHJlY29y
ZGluZyB0aGUgdHJhbnNhY3Rpb24gSUQgb2YgdGhlDQpAQCAtMTAxLDIzICsxMDEsMTcgQEAgc3Rh
dGljIHN0cnVjdCBrbWVtX2NhY2hlICpqYmQyX3Jldm9rZV90YWJsZV9jYWNoZTsNCg0Kc3RydWN0
IGpiZDJfcmV2b2tlX3JlY29yZF9zDQp7DQotCXN0cnVjdCBsaXN0X2hlYWQgIGhhc2g7DQorCXN0
cnVjdCByaGFzaF9oZWFkIGxpbmthZ2U7DQoJdGlkX3QJCSAgc2VxdWVuY2U7CS8qIFVzZWQgZm9y
IHJlY292ZXJ5IG9ubHkgKi8NCgl1bnNpZ25lZCBsb25nIGxvbmcJICBibG9ja25yOw0KfTsNCg0K
LQ0KLS8qIFRoZSByZXZva2UgdGFibGUgaXMganVzdCBhIHNpbXBsZSBoYXNoIHRhYmxlIG9mIHJl
dm9rZSByZWNvcmRzLiAqLw0KLXN0cnVjdCBqYmQyX3Jldm9rZV90YWJsZV9zDQotew0KLQkvKiBJ
dCBpcyBjb25jZWl2YWJsZSB0aGF0IHdlIG1pZ2h0IHdhbnQgYSBsYXJnZXIgaGFzaCB0YWJsZQ0K
LQkgKiBmb3IgcmVjb3ZlcnkuICBNdXN0IGJlIGEgcG93ZXIgb2YgdHdvLiAqLw0KLQlpbnQJCSAg
aGFzaF9zaXplOw0KLQlpbnQJCSAgaGFzaF9zaGlmdDsNCi0Jc3RydWN0IGxpc3RfaGVhZCAqaGFz
aF90YWJsZTsNCitzdGF0aWMgY29uc3Qgc3RydWN0IHJoYXNodGFibGVfcGFyYW1zIHJldm9rZV9y
aGFzaHRhYmxlX3BhcmFtcyA9IHsNCisJLmtleV9sZW4gICAgID0gc2l6ZW9mKHVuc2lnbmVkIGxv
bmcgbG9uZyksDQorCS5rZXlfb2Zmc2V0ICA9IG9mZnNldG9mKHN0cnVjdCBqYmQyX3Jldm9rZV9y
ZWNvcmRfcywgYmxvY2tuciksDQorCS5oZWFkX29mZnNldCA9IG9mZnNldG9mKHN0cnVjdCBqYmQy
X3Jldm9rZV9yZWNvcmRfcywgbGlua2FnZSksDQp9Ow0KDQotDQojaWZkZWYgX19LRVJORUxfXw0K
c3RhdGljIHZvaWQgd3JpdGVfb25lX3Jldm9rZV9yZWNvcmQodHJhbnNhY3Rpb25fdCAqLA0KCQkJ
CSAgICBzdHJ1Y3QgbGlzdF9oZWFkICosDQpAQCAtMTI2LDE4ICsxMjAsMTAgQEAgc3RhdGljIHZv
aWQgd3JpdGVfb25lX3Jldm9rZV9yZWNvcmQodHJhbnNhY3Rpb25fdCAqLA0Kc3RhdGljIHZvaWQg
Zmx1c2hfZGVzY3JpcHRvcihqb3VybmFsX3QgKiwgc3RydWN0IGJ1ZmZlcl9oZWFkICosIGludCk7
DQojZW5kaWYNCg0KLS8qIFV0aWxpdHkgZnVuY3Rpb25zIHRvIG1haW50YWluIHRoZSByZXZva2Ug
dGFibGUgKi8NCi0NCi1zdGF0aWMgaW5saW5lIGludCBoYXNoKGpvdXJuYWxfdCAqam91cm5hbCwg
dW5zaWduZWQgbG9uZyBsb25nIGJsb2NrKQ0KLXsNCi0JcmV0dXJuIGhhc2hfNjQoYmxvY2ssIGpv
dXJuYWwtPmpfcmV2b2tlLT5oYXNoX3NoaWZ0KTsNCi19DQotDQpzdGF0aWMgaW50IGluc2VydF9y
ZXZva2VfaGFzaChqb3VybmFsX3QgKmpvdXJuYWwsIHVuc2lnbmVkIGxvbmcgbG9uZyBibG9ja25y
LA0KCQkJICAgICAgdGlkX3Qgc2VxKQ0Kew0KLQlzdHJ1Y3QgbGlzdF9oZWFkICpoYXNoX2xpc3Q7
DQotCXN0cnVjdCBqYmQyX3Jldm9rZV9yZWNvcmRfcyAqcmVjb3JkOw0KKwlzdHJ1Y3QgamJkMl9y
ZXZva2VfcmVjb3JkX3MgKnJlY29yZCwgKm9sZDsNCglnZnBfdCBnZnBfbWFzayA9IEdGUF9OT0ZT
Ow0KDQoJaWYgKGpvdXJuYWxfb29tX3JldHJ5KQ0KQEAgLTE0OCwxMCArMTM0LDEyIEBAIHN0YXRp
YyBpbnQgaW5zZXJ0X3Jldm9rZV9oYXNoKGpvdXJuYWxfdCAqam91cm5hbCwgdW5zaWduZWQgbG9u
ZyBsb25nIGJsb2NrbnIsDQoNCglyZWNvcmQtPnNlcXVlbmNlID0gc2VxOw0KCXJlY29yZC0+Ymxv
Y2tuciA9IGJsb2NrbnI7DQotCWhhc2hfbGlzdCA9ICZqb3VybmFsLT5qX3Jldm9rZS0+aGFzaF90
YWJsZVtoYXNoKGpvdXJuYWwsIGJsb2NrbnIpXTsNCi0Jc3Bpbl9sb2NrKCZqb3VybmFsLT5qX3Jl
dm9rZV9sb2NrKTsNCi0JbGlzdF9hZGQoJnJlY29yZC0+aGFzaCwgaGFzaF9saXN0KTsNCi0Jc3Bp
bl91bmxvY2soJmpvdXJuYWwtPmpfcmV2b2tlX2xvY2spOw0KKwlvbGQgPSByaGFzaHRhYmxlX2xv
b2t1cF9nZXRfaW5zZXJ0X2Zhc3Qoam91cm5hbC0+al9yZXZva2UsDQorCQkJCQkgJnJlY29yZC0+
bGlua2FnZSwgcmV2b2tlX3JoYXNodGFibGVfcGFyYW1zKTsNCisJaWYgKG9sZCkgew0KKwkJQlVH
X09OKHJlY29yZC0+c2VxdWVuY2UgIT0gc2VxKTsNCisJCWttZW1fY2FjaGVfZnJlZShqYmQyX3Jl
dm9rZV9yZWNvcmRfY2FjaGUsIHJlY29yZCk7DQorCX0NCglyZXR1cm4gMDsNCn0NCg0KQEAgLTE2
MCwyMiArMTQ4LDggQEAgc3RhdGljIGludCBpbnNlcnRfcmV2b2tlX2hhc2goam91cm5hbF90ICpq
b3VybmFsLCB1bnNpZ25lZCBsb25nIGxvbmcgYmxvY2tuciwNCnN0YXRpYyBzdHJ1Y3QgamJkMl9y
ZXZva2VfcmVjb3JkX3MgKmZpbmRfcmV2b2tlX3JlY29yZChqb3VybmFsX3QgKmpvdXJuYWwsDQoJ
CQkJCQkgICAgICB1bnNpZ25lZCBsb25nIGxvbmcgYmxvY2tucikNCnsNCi0Jc3RydWN0IGxpc3Rf
aGVhZCAqaGFzaF9saXN0Ow0KLQlzdHJ1Y3QgamJkMl9yZXZva2VfcmVjb3JkX3MgKnJlY29yZDsN
Ci0NCi0JaGFzaF9saXN0ID0gJmpvdXJuYWwtPmpfcmV2b2tlLT5oYXNoX3RhYmxlW2hhc2goam91
cm5hbCwgYmxvY2tucildOw0KLQ0KLQlzcGluX2xvY2soJmpvdXJuYWwtPmpfcmV2b2tlX2xvY2sp
Ow0KLQlyZWNvcmQgPSAoc3RydWN0IGpiZDJfcmV2b2tlX3JlY29yZF9zICopIGhhc2hfbGlzdC0+
bmV4dDsNCi0Jd2hpbGUgKCYocmVjb3JkLT5oYXNoKSAhPSBoYXNoX2xpc3QpIHsNCi0JCWlmIChy
ZWNvcmQtPmJsb2NrbnIgPT0gYmxvY2tucikgew0KLQkJCXNwaW5fdW5sb2NrKCZqb3VybmFsLT5q
X3Jldm9rZV9sb2NrKTsNCi0JCQlyZXR1cm4gcmVjb3JkOw0KLQkJfQ0KLQkJcmVjb3JkID0gKHN0
cnVjdCBqYmQyX3Jldm9rZV9yZWNvcmRfcyAqKSByZWNvcmQtPmhhc2gubmV4dDsNCi0JfQ0KLQlz
cGluX3VubG9jaygmam91cm5hbC0+al9yZXZva2VfbG9jayk7DQotCXJldHVybiBOVUxMOw0KKwly
ZXR1cm4gcmhhc2h0YWJsZV9sb29rdXBfZmFzdChqb3VybmFsLT5qX3Jldm9rZSwgJmJsb2NrbnIs
DQorCQkJCSAgICAgIHJldm9rZV9yaGFzaHRhYmxlX3BhcmFtcyk7DQp9DQoNCnZvaWQgamJkMl9q
b3VybmFsX2Rlc3Ryb3lfcmV2b2tlX3JlY29yZF9jYWNoZSh2b2lkKQ0KQEAgLTE4NCwxMiArMTU4
LDYgQEAgdm9pZCBqYmQyX2pvdXJuYWxfZGVzdHJveV9yZXZva2VfcmVjb3JkX2NhY2hlKHZvaWQp
DQoJamJkMl9yZXZva2VfcmVjb3JkX2NhY2hlID0gTlVMTDsNCn0NCg0KLXZvaWQgamJkMl9qb3Vy
bmFsX2Rlc3Ryb3lfcmV2b2tlX3RhYmxlX2NhY2hlKHZvaWQpDQotew0KLQlrbWVtX2NhY2hlX2Rl
c3Ryb3koamJkMl9yZXZva2VfdGFibGVfY2FjaGUpOw0KLQlqYmQyX3Jldm9rZV90YWJsZV9jYWNo
ZSA9IE5VTEw7DQotfQ0KLQ0KaW50IF9faW5pdCBqYmQyX2pvdXJuYWxfaW5pdF9yZXZva2VfcmVj
b3JkX2NhY2hlKHZvaWQpDQp7DQoJSl9BU1NFUlQoIWpiZDJfcmV2b2tlX3JlY29yZF9jYWNoZSk7
DQpAQCAtMjAzLDg1ICsxNzEsMjcgQEAgaW50IF9faW5pdCBqYmQyX2pvdXJuYWxfaW5pdF9yZXZv
a2VfcmVjb3JkX2NhY2hlKHZvaWQpDQoJcmV0dXJuIDA7DQp9DQoNCi1pbnQgX19pbml0IGpiZDJf
am91cm5hbF9pbml0X3Jldm9rZV90YWJsZV9jYWNoZSh2b2lkKQ0KLXsNCi0JSl9BU1NFUlQoIWpi
ZDJfcmV2b2tlX3RhYmxlX2NhY2hlKTsNCi0JamJkMl9yZXZva2VfdGFibGVfY2FjaGUgPSBLTUVN
X0NBQ0hFKGpiZDJfcmV2b2tlX3RhYmxlX3MsDQotCQkJCQkgICAgIFNMQUJfVEVNUE9SQVJZKTsN
Ci0JaWYgKCFqYmQyX3Jldm9rZV90YWJsZV9jYWNoZSkgew0KLQkJcHJfZW1lcmcoIkpCRDI6IGZh
aWxlZCB0byBjcmVhdGUgcmV2b2tlX3RhYmxlIGNhY2hlXG4iKTsNCi0JCXJldHVybiAtRU5PTUVN
Ow0KLQl9DQotCXJldHVybiAwOw0KLX0NCi0NCi1zdGF0aWMgc3RydWN0IGpiZDJfcmV2b2tlX3Rh
YmxlX3MgKmpiZDJfam91cm5hbF9pbml0X3Jldm9rZV90YWJsZShpbnQgaGFzaF9zaXplKQ0KLXsN
Ci0JaW50IHNoaWZ0ID0gMDsNCi0JaW50IHRtcCA9IGhhc2hfc2l6ZTsNCi0Jc3RydWN0IGpiZDJf
cmV2b2tlX3RhYmxlX3MgKnRhYmxlOw0KLQ0KLQl0YWJsZSA9IGttZW1fY2FjaGVfYWxsb2MoamJk
Ml9yZXZva2VfdGFibGVfY2FjaGUsIEdGUF9LRVJORUwpOw0KLQlpZiAoIXRhYmxlKQ0KLQkJZ290
byBvdXQ7DQotDQotCXdoaWxlKCh0bXAgPj49IDFVTCkgIT0gMFVMKQ0KLQkJc2hpZnQrKzsNCi0N
Ci0JdGFibGUtPmhhc2hfc2l6ZSA9IGhhc2hfc2l6ZTsNCi0JdGFibGUtPmhhc2hfc2hpZnQgPSBz
aGlmdDsNCi0JdGFibGUtPmhhc2hfdGFibGUgPQ0KLQkJa21hbGxvY19hcnJheShoYXNoX3NpemUs
IHNpemVvZihzdHJ1Y3QgbGlzdF9oZWFkKSwgR0ZQX0tFUk5FTCk7DQotCWlmICghdGFibGUtPmhh
c2hfdGFibGUpIHsNCi0JCWttZW1fY2FjaGVfZnJlZShqYmQyX3Jldm9rZV90YWJsZV9jYWNoZSwg
dGFibGUpOw0KLQkJdGFibGUgPSBOVUxMOw0KLQkJZ290byBvdXQ7DQotCX0NCi0NCi0JZm9yICh0
bXAgPSAwOyB0bXAgPCBoYXNoX3NpemU7IHRtcCsrKQ0KLQkJSU5JVF9MSVNUX0hFQUQoJnRhYmxl
LT5oYXNoX3RhYmxlW3RtcF0pOw0KLQ0KLW91dDoNCi0JcmV0dXJuIHRhYmxlOw0KLX0NCi0NCi1z
dGF0aWMgdm9pZCBqYmQyX2pvdXJuYWxfZGVzdHJveV9yZXZva2VfdGFibGUoc3RydWN0IGpiZDJf
cmV2b2tlX3RhYmxlX3MgKnRhYmxlKQ0KLXsNCi0JaW50IGk7DQotCXN0cnVjdCBsaXN0X2hlYWQg
Kmhhc2hfbGlzdDsNCi0NCi0JZm9yIChpID0gMDsgaSA8IHRhYmxlLT5oYXNoX3NpemU7IGkrKykg
ew0KLQkJaGFzaF9saXN0ID0gJnRhYmxlLT5oYXNoX3RhYmxlW2ldOw0KLQkJSl9BU1NFUlQobGlz
dF9lbXB0eShoYXNoX2xpc3QpKTsNCi0JfQ0KLQ0KLQlrZnJlZSh0YWJsZS0+aGFzaF90YWJsZSk7
DQotCWttZW1fY2FjaGVfZnJlZShqYmQyX3Jldm9rZV90YWJsZV9jYWNoZSwgdGFibGUpOw0KLX0N
Ci0NCi8qIEluaXRpYWxpc2UgdGhlIHJldm9rZSB0YWJsZSBmb3IgYSBnaXZlbiBqb3VybmFsIHRv
IGEgZ2l2ZW4gc2l6ZS4gKi8NCi1pbnQgamJkMl9qb3VybmFsX2luaXRfcmV2b2tlKGpvdXJuYWxf
dCAqam91cm5hbCwgaW50IGhhc2hfc2l6ZSkNCitpbnQgamJkMl9qb3VybmFsX2luaXRfcmV2b2tl
KGpvdXJuYWxfdCAqam91cm5hbCkNCnsNCi0JSl9BU1NFUlQoam91cm5hbC0+al9yZXZva2VfdGFi
bGVbMF0gPT0gTlVMTCk7DQotCUpfQVNTRVJUKGlzX3Bvd2VyX29mXzIoaGFzaF9zaXplKSk7DQor
CWludCByYzsNCg0KLQlqb3VybmFsLT5qX3Jldm9rZV90YWJsZVswXSA9IGpiZDJfam91cm5hbF9p
bml0X3Jldm9rZV90YWJsZShoYXNoX3NpemUpOw0KLQlpZiAoIWpvdXJuYWwtPmpfcmV2b2tlX3Rh
YmxlWzBdKQ0KKwlyYyA9IHJoYXNodGFibGVfaW5pdCgmam91cm5hbC0+al9yZXZva2VfdGFibGVb
MF0sICZyZXZva2Vfcmhhc2h0YWJsZV9wYXJhbXMpOw0KKwlpZiAocmMpDQoJCWdvdG8gZmFpbDA7
DQoNCi0Jam91cm5hbC0+al9yZXZva2VfdGFibGVbMV0gPSBqYmQyX2pvdXJuYWxfaW5pdF9yZXZv
a2VfdGFibGUoaGFzaF9zaXplKTsNCi0JaWYgKCFqb3VybmFsLT5qX3Jldm9rZV90YWJsZVsxXSkN
CisJcmMgPSByaGFzaHRhYmxlX2luaXQoJmpvdXJuYWwtPmpfcmV2b2tlX3RhYmxlWzFdLCAmcmV2
b2tlX3JoYXNodGFibGVfcGFyYW1zKTsNCisJaWYgKHJjKQ0KCQlnb3RvIGZhaWwxOw0KDQotCWpv
dXJuYWwtPmpfcmV2b2tlID0gam91cm5hbC0+al9yZXZva2VfdGFibGVbMV07DQorCWpvdXJuYWwt
PmpfcmV2b2tlID0gJmpvdXJuYWwtPmpfcmV2b2tlX3RhYmxlWzFdOw0KDQoJc3Bpbl9sb2NrX2lu
aXQoJmpvdXJuYWwtPmpfcmV2b2tlX2xvY2spOw0KDQoJcmV0dXJuIDA7DQoNCmZhaWwxOg0KLQlq
YmQyX2pvdXJuYWxfZGVzdHJveV9yZXZva2VfdGFibGUoam91cm5hbC0+al9yZXZva2VfdGFibGVb
MF0pOw0KLQlqb3VybmFsLT5qX3Jldm9rZV90YWJsZVswXSA9IE5VTEw7DQorCXJoYXNodGFibGVf
ZGVzdHJveSgmam91cm5hbC0+al9yZXZva2VfdGFibGVbMF0pOw0KZmFpbDA6DQoJcmV0dXJuIC1F
Tk9NRU07DQp9DQpAQCAtMjkwLDEwICsyMDAsOCBAQCBpbnQgamJkMl9qb3VybmFsX2luaXRfcmV2
b2tlKGpvdXJuYWxfdCAqam91cm5hbCwgaW50IGhhc2hfc2l6ZSkNCnZvaWQgamJkMl9qb3VybmFs
X2Rlc3Ryb3lfcmV2b2tlKGpvdXJuYWxfdCAqam91cm5hbCkNCnsNCglqb3VybmFsLT5qX3Jldm9r
ZSA9IE5VTEw7DQotCWlmIChqb3VybmFsLT5qX3Jldm9rZV90YWJsZVswXSkNCi0JCWpiZDJfam91
cm5hbF9kZXN0cm95X3Jldm9rZV90YWJsZShqb3VybmFsLT5qX3Jldm9rZV90YWJsZVswXSk7DQot
CWlmIChqb3VybmFsLT5qX3Jldm9rZV90YWJsZVsxXSkNCi0JCWpiZDJfam91cm5hbF9kZXN0cm95
X3Jldm9rZV90YWJsZShqb3VybmFsLT5qX3Jldm9rZV90YWJsZVsxXSk7DQorCXJoYXNodGFibGVf
ZGVzdHJveSgmam91cm5hbC0+al9yZXZva2VfdGFibGVbMF0pOw0KKwlyaGFzaHRhYmxlX2Rlc3Ry
b3koJmpvdXJuYWwtPmpfcmV2b2tlX3RhYmxlWzFdKTsNCn0NCg0KDQpAQCAtNDQ2LDkgKzM1NCw4
IEBAIGludCBqYmQyX2pvdXJuYWxfY2FuY2VsX3Jldm9rZShoYW5kbGVfdCAqaGFuZGxlLCBzdHJ1
Y3Qgam91cm5hbF9oZWFkICpqaCkNCgkJaWYgKHJlY29yZCkgew0KCQkJamJkX2RlYnVnKDQsICJj
YW5jZWxsZWQgZXhpc3RpbmcgcmV2b2tlIG9uICINCgkJCQkgICJibG9ja25yICVsbHVcbiIsICh1
bnNpZ25lZCBsb25nIGxvbmcpYmgtPmJfYmxvY2tucik7DQotCQkJc3Bpbl9sb2NrKCZqb3VybmFs
LT5qX3Jldm9rZV9sb2NrKTsNCi0JCQlsaXN0X2RlbCgmcmVjb3JkLT5oYXNoKTsNCi0JCQlzcGlu
X3VubG9jaygmam91cm5hbC0+al9yZXZva2VfbG9jayk7DQorCQkJcmhhc2h0YWJsZV9yZW1vdmVf
ZmFzdChqb3VybmFsLT5qX3Jldm9rZSwgJnJlY29yZC0+bGlua2FnZSwNCisJCQkJCQlyZXZva2Vf
cmhhc2h0YWJsZV9wYXJhbXMpOw0KCQkJa21lbV9jYWNoZV9mcmVlKGpiZDJfcmV2b2tlX3JlY29y
ZF9jYWNoZSwgcmVjb3JkKTsNCgkJCWRpZF9yZXZva2UgPSAxOw0KCQl9DQpAQCAtNDgzLDI3ICsz
OTAsMjkgQEAgaW50IGpiZDJfam91cm5hbF9jYW5jZWxfcmV2b2tlKGhhbmRsZV90ICpoYW5kbGUs
IHN0cnVjdCBqb3VybmFsX2hlYWQgKmpoKQ0KICovDQp2b2lkIGpiZDJfY2xlYXJfYnVmZmVyX3Jl
dm9rZWRfZmxhZ3Moam91cm5hbF90ICpqb3VybmFsKQ0Kew0KLQlzdHJ1Y3QgamJkMl9yZXZva2Vf
dGFibGVfcyAqcmV2b2tlID0gam91cm5hbC0+al9yZXZva2U7DQotCWludCBpID0gMDsNCi0NCi0J
Zm9yIChpID0gMDsgaSA8IHJldm9rZS0+aGFzaF9zaXplOyBpKyspIHsNCi0JCXN0cnVjdCBsaXN0
X2hlYWQgKmhhc2hfbGlzdDsNCi0JCXN0cnVjdCBsaXN0X2hlYWQgKmxpc3RfZW50cnk7DQotCQlo
YXNoX2xpc3QgPSAmcmV2b2tlLT5oYXNoX3RhYmxlW2ldOw0KLQ0KLQkJbGlzdF9mb3JfZWFjaChs
aXN0X2VudHJ5LCBoYXNoX2xpc3QpIHsNCi0JCQlzdHJ1Y3QgamJkMl9yZXZva2VfcmVjb3JkX3Mg
KnJlY29yZDsNCi0JCQlzdHJ1Y3QgYnVmZmVyX2hlYWQgKmJoOw0KLQkJCXJlY29yZCA9IChzdHJ1
Y3QgamJkMl9yZXZva2VfcmVjb3JkX3MgKilsaXN0X2VudHJ5Ow0KLQkJCWJoID0gX19maW5kX2dl
dF9ibG9jayhqb3VybmFsLT5qX2ZzX2RldiwNCi0JCQkJCSAgICAgIHJlY29yZC0+YmxvY2tuciwN
Ci0JCQkJCSAgICAgIGpvdXJuYWwtPmpfYmxvY2tzaXplKTsNCi0JCQlpZiAoYmgpIHsNCi0JCQkJ
Y2xlYXJfYnVmZmVyX3Jldm9rZWQoYmgpOw0KLQkJCQlfX2JyZWxzZShiaCk7DQotCQkJfQ0KKwlz
dHJ1Y3Qgcmhhc2h0YWJsZSAqcmV2b2tlID0gam91cm5hbC0+al9yZXZva2U7DQorCXN0cnVjdCBq
YmQyX3Jldm9rZV9yZWNvcmRfcyAqcmVjb3JkOw0KKwlzdHJ1Y3Qgcmhhc2h0YWJsZV9pdGVyIGl0
ZXI7DQorDQorICAgICAgICByaGFzaHRhYmxlX3dhbGtfZW50ZXIocmV2b2tlLCAmaXRlcik7DQor
ICAgICAgICByaGFzaHRhYmxlX3dhbGtfc3RhcnQoJml0ZXIpOw0KKyAgICAgICAgd2hpbGUgKChy
ZWNvcmQgPSByaGFzaHRhYmxlX3dhbGtfbmV4dCgmaXRlcikpICE9IE5VTEwpIHsNCisJCXN0cnVj
dCBidWZmZXJfaGVhZCAqYmg7DQorDQorCQlpZiAoSVNfRVJSKHJlY29yZCkpDQorCQkJY29udGlu
dWU7DQorCQlyaGFzaHRhYmxlX3dhbGtfc3RvcCgmaXRlcik7DQorCQliaCA9IF9fZmluZF9nZXRf
YmxvY2soam91cm5hbC0+al9mc19kZXYsDQorCQkJCSAgICAgIHJlY29yZC0+YmxvY2tuciwNCisJ
CQkJICAgICAgam91cm5hbC0+al9ibG9ja3NpemUpOw0KKwkJaWYgKGJoKSB7DQorCQkJY2xlYXJf
YnVmZmVyX3Jldm9rZWQoYmgpOw0KKwkJCV9fYnJlbHNlKGJoKTsNCgkJfQ0KLQl9DQorCQlyaGFz
aHRhYmxlX3dhbGtfc3RhcnQoJml0ZXIpOw0KKyAgICAgICAgfQ0KKyAgICAgICAgcmhhc2h0YWJs
ZV93YWxrX3N0b3AoJml0ZXIpOw0KKyAgICAgICAgcmhhc2h0YWJsZV93YWxrX2V4aXQoJml0ZXIp
Ow0KfQ0KDQovKiBqb3VybmFsX3N3aXRjaF9yZXZva2UgdGFibGUgc2VsZWN0IGpfcmV2b2tlIGZv
ciBuZXh0IHRyYW5zYWN0aW9uDQpAQCAtNTEyLDE1ICs0MjEsMTIgQEAgdm9pZCBqYmQyX2NsZWFy
X2J1ZmZlcl9yZXZva2VkX2ZsYWdzKGpvdXJuYWxfdCAqam91cm5hbCkNCiAqLw0Kdm9pZCBqYmQy
X2pvdXJuYWxfc3dpdGNoX3Jldm9rZV90YWJsZShqb3VybmFsX3QgKmpvdXJuYWwpDQp7DQotCWlu
dCBpOw0KLQ0KLQlpZiAoam91cm5hbC0+al9yZXZva2UgPT0gam91cm5hbC0+al9yZXZva2VfdGFi
bGVbMF0pDQotCQlqb3VybmFsLT5qX3Jldm9rZSA9IGpvdXJuYWwtPmpfcmV2b2tlX3RhYmxlWzFd
Ow0KKwlpZiAoam91cm5hbC0+al9yZXZva2UgPT0gJmpvdXJuYWwtPmpfcmV2b2tlX3RhYmxlWzBd
KQ0KKwkJam91cm5hbC0+al9yZXZva2UgPSAmam91cm5hbC0+al9yZXZva2VfdGFibGVbMV07DQoJ
ZWxzZQ0KLQkJam91cm5hbC0+al9yZXZva2UgPSBqb3VybmFsLT5qX3Jldm9rZV90YWJsZVswXTsN
CisJCWpvdXJuYWwtPmpfcmV2b2tlID0gJmpvdXJuYWwtPmpfcmV2b2tlX3RhYmxlWzBdOw0KDQot
CWZvciAoaSA9IDA7IGkgPCBqb3VybmFsLT5qX3Jldm9rZS0+aGFzaF9zaXplOyBpKyspDQotCQlJ
TklUX0xJU1RfSEVBRCgmam91cm5hbC0+al9yZXZva2UtPmhhc2hfdGFibGVbaV0pOw0KKwkvKiBY
WFg6IGNoZWNrIHJoYXNodGFibGUgaXMgZW1wdHk/IHJlaW5pdGlhbGl6ZSBpdD8gKi8NCn0NCg0K
LyoNCkBAIC01MzMsMzEgKzQzOSwzNiBAQCB2b2lkIGpiZDJfam91cm5hbF93cml0ZV9yZXZva2Vf
cmVjb3Jkcyh0cmFuc2FjdGlvbl90ICp0cmFuc2FjdGlvbiwNCglqb3VybmFsX3QgKmpvdXJuYWwg
PSB0cmFuc2FjdGlvbi0+dF9qb3VybmFsOw0KCXN0cnVjdCBidWZmZXJfaGVhZCAqZGVzY3JpcHRv
cjsNCglzdHJ1Y3QgamJkMl9yZXZva2VfcmVjb3JkX3MgKnJlY29yZDsNCi0Jc3RydWN0IGpiZDJf
cmV2b2tlX3RhYmxlX3MgKnJldm9rZTsNCi0Jc3RydWN0IGxpc3RfaGVhZCAqaGFzaF9saXN0Ow0K
LQlpbnQgaSwgb2Zmc2V0LCBjb3VudDsNCisJc3RydWN0IHJoYXNodGFibGVfaXRlciBpdGVyOw0K
KwlzdHJ1Y3Qgcmhhc2h0YWJsZSAqcmV2b2tlOw0KKwlpbnQgb2Zmc2V0LCBjb3VudDsNCg0KCWRl
c2NyaXB0b3IgPSBOVUxMOw0KCW9mZnNldCA9IDA7DQoJY291bnQgPSAwOw0KDQoJLyogc2VsZWN0
IHJldm9rZSB0YWJsZSBmb3IgY29tbWl0dGluZyB0cmFuc2FjdGlvbiAqLw0KLQlyZXZva2UgPSBq
b3VybmFsLT5qX3Jldm9rZSA9PSBqb3VybmFsLT5qX3Jldm9rZV90YWJsZVswXSA/DQotCQlqb3Vy
bmFsLT5qX3Jldm9rZV90YWJsZVsxXSA6IGpvdXJuYWwtPmpfcmV2b2tlX3RhYmxlWzBdOw0KLQ0K
LQlmb3IgKGkgPSAwOyBpIDwgcmV2b2tlLT5oYXNoX3NpemU7IGkrKykgew0KLQkJaGFzaF9saXN0
ID0gJnJldm9rZS0+aGFzaF90YWJsZVtpXTsNCi0NCi0JCXdoaWxlICghbGlzdF9lbXB0eShoYXNo
X2xpc3QpKSB7DQotCQkJcmVjb3JkID0gKHN0cnVjdCBqYmQyX3Jldm9rZV9yZWNvcmRfcyAqKQ0K
LQkJCQloYXNoX2xpc3QtPm5leHQ7DQorCXJldm9rZSA9IGpvdXJuYWwtPmpfcmV2b2tlID09ICZq
b3VybmFsLT5qX3Jldm9rZV90YWJsZVswXSA/DQorCQkmam91cm5hbC0+al9yZXZva2VfdGFibGVb
MV0gOiAmam91cm5hbC0+al9yZXZva2VfdGFibGVbMF07DQorDQorCXJoYXNodGFibGVfd2Fsa19l
bnRlcihyZXZva2UsICZpdGVyKTsNCisJcmhhc2h0YWJsZV93YWxrX3N0YXJ0KCZpdGVyKTsNCisJ
d2hpbGUgKChyZWNvcmQgPSByaGFzaHRhYmxlX3dhbGtfbmV4dCgmaXRlcikpICE9IE5VTEwpIHsN
CisJCWlmIChJU19FUlIocmVjb3JkKSkNCisJCQljb250aW51ZTsNCisJCWlmIChyaGFzaHRhYmxl
X3JlbW92ZV9mYXN0KHJldm9rZSwNCisJCQkJCSAgICZyZWNvcmQtPmxpbmthZ2UsDQorCQkJCQkg
ICByZXZva2Vfcmhhc2h0YWJsZV9wYXJhbXMpID09IDApIHsNCisJCQlyaGFzaHRhYmxlX3dhbGtf
c3RvcCgmaXRlcik7DQoJCQl3cml0ZV9vbmVfcmV2b2tlX3JlY29yZCh0cmFuc2FjdGlvbiwgbG9n
X2J1ZnMsDQoJCQkJCQkmZGVzY3JpcHRvciwgJm9mZnNldCwgcmVjb3JkKTsNCisJCQlyaGFzaHRh
YmxlX3dhbGtfc3RhcnQoJml0ZXIpOw0KCQkJY291bnQrKzsNCi0JCQlsaXN0X2RlbCgmcmVjb3Jk
LT5oYXNoKTsNCgkJCWttZW1fY2FjaGVfZnJlZShqYmQyX3Jldm9rZV9yZWNvcmRfY2FjaGUsIHJl
Y29yZCk7DQoJCX0NCgl9DQorCXJoYXNodGFibGVfd2Fsa19zdG9wKCZpdGVyKTsNCisJcmhhc2h0
YWJsZV93YWxrX2V4aXQoJml0ZXIpOw0KCWlmIChkZXNjcmlwdG9yKQ0KCQlmbHVzaF9kZXNjcmlw
dG9yKGpvdXJuYWwsIGRlc2NyaXB0b3IsIG9mZnNldCk7DQoJamJkX2RlYnVnKDEsICJXcm90ZSAl
ZCByZXZva2UgcmVjb3Jkc1xuIiwgY291bnQpOw0KQEAgLTcyNSwxOSArNjM2LDIzIEBAIGludCBq
YmQyX2pvdXJuYWxfdGVzdF9yZXZva2Uoam91cm5hbF90ICpqb3VybmFsLA0KDQp2b2lkIGpiZDJf
am91cm5hbF9jbGVhcl9yZXZva2Uoam91cm5hbF90ICpqb3VybmFsKQ0Kew0KLQlpbnQgaTsNCi0J
c3RydWN0IGxpc3RfaGVhZCAqaGFzaF9saXN0Ow0KKwlzdHJ1Y3Qgcmhhc2h0YWJsZV9pdGVyIGl0
ZXI7DQoJc3RydWN0IGpiZDJfcmV2b2tlX3JlY29yZF9zICpyZWNvcmQ7DQotCXN0cnVjdCBqYmQy
X3Jldm9rZV90YWJsZV9zICpyZXZva2U7DQorCXN0cnVjdCByaGFzaHRhYmxlICpyZXZva2U7DQoN
CglyZXZva2UgPSBqb3VybmFsLT5qX3Jldm9rZTsNCg0KLQlmb3IgKGkgPSAwOyBpIDwgcmV2b2tl
LT5oYXNoX3NpemU7IGkrKykgew0KLQkJaGFzaF9saXN0ID0gJnJldm9rZS0+aGFzaF90YWJsZVtp
XTsNCi0JCXdoaWxlICghbGlzdF9lbXB0eShoYXNoX2xpc3QpKSB7DQotCQkJcmVjb3JkID0gKHN0
cnVjdCBqYmQyX3Jldm9rZV9yZWNvcmRfcyopIGhhc2hfbGlzdC0+bmV4dDsNCi0JCQlsaXN0X2Rl
bCgmcmVjb3JkLT5oYXNoKTsNCisgICAgICAgIHJoYXNodGFibGVfd2Fsa19lbnRlcihyZXZva2Us
ICZpdGVyKTsNCisgICAgICAgIHJoYXNodGFibGVfd2Fsa19zdGFydCgmaXRlcik7DQorICAgICAg
ICB3aGlsZSAoKHJlY29yZCA9IHJoYXNodGFibGVfd2Fsa19uZXh0KCZpdGVyKSkgIT0gTlVMTCkg
ew0KKwkJaWYgKElTX0VSUihyZWNvcmQpKQ0KKwkJCWNvbnRpbnVlOw0KKyAgICAgICAgICAgICAg
ICBpZiAocmhhc2h0YWJsZV9yZW1vdmVfZmFzdChyZXZva2UsDQorICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICZyZWNvcmQtPmxpbmthZ2UsDQorICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldm9rZV9yaGFzaHRhYmxlX3BhcmFtcykg
PT0gMCkgew0KCQkJa21lbV9jYWNoZV9mcmVlKGpiZDJfcmV2b2tlX3JlY29yZF9jYWNoZSwgcmVj
b3JkKTsNCi0JCX0NCi0JfQ0KKyAgICAgICAgICAgICAgICB9DQorICAgICAgICB9DQorICAgICAg
ICByaGFzaHRhYmxlX3dhbGtfc3RvcCgmaXRlcik7DQorICAgICAgICByaGFzaHRhYmxlX3dhbGtf
ZXhpdCgmaXRlcik7DQp9DQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9qYmQyLmggYi9pbmNs
dWRlL2xpbnV4L2piZDIuaA0KaW5kZXggZmQ5MzNjNDUyODFhLi5kY2RlNDMyOWNkZDEgMTAwNjQ0
DQotLS0gYS9pbmNsdWRlL2xpbnV4L2piZDIuaA0KKysrIGIvaW5jbHVkZS9saW51eC9qYmQyLmgN
CkBAIC0yOSw2ICsyOSw3IEBADQojaW5jbHVkZSA8bGludXgvYml0X3NwaW5sb2NrLmg+DQojaW5j
bHVkZSA8bGludXgvYmxrZGV2Lmg+DQojaW5jbHVkZSA8Y3J5cHRvL2hhc2guaD4NCisjaW5jbHVk
ZSA8bGludXgvcmhhc2h0YWJsZS5oPg0KI2VuZGlmDQoNCiNkZWZpbmUgam91cm5hbF9vb21fcmV0
cnkgMQ0KQEAgLTExMzUsMTIgKzExMzYsMTIgQEAgc3RydWN0IGpvdXJuYWxfcw0KCSAqIFRoZSBy
ZXZva2UgdGFibGUgLSBtYWludGFpbnMgdGhlIGxpc3Qgb2YgcmV2b2tlZCBibG9ja3MgaW4gdGhl
DQoJICogY3VycmVudCB0cmFuc2FjdGlvbi4NCgkgKi8NCi0Jc3RydWN0IGpiZDJfcmV2b2tlX3Rh
YmxlX3MgKmpfcmV2b2tlOw0KKwlzdHJ1Y3Qgcmhhc2h0YWJsZQkqal9yZXZva2U7DQoNCgkvKioN
CgkgKiBAal9yZXZva2VfdGFibGU6IEFsdGVybmF0ZSByZXZva2UgdGFibGVzIGZvciBqX3Jldm9r
ZS4NCgkgKi8NCi0Jc3RydWN0IGpiZDJfcmV2b2tlX3RhYmxlX3MgKmpfcmV2b2tlX3RhYmxlWzJd
Ow0KKwlzdHJ1Y3Qgcmhhc2h0YWJsZQlqX3Jldm9rZV90YWJsZVsyXTsNCg0KCS8qKg0KCSAqIEBq
X3didWY6IEFycmF5IG9mIGJocyBmb3IgamJkMl9qb3VybmFsX2NvbW1pdF90cmFuc2FjdGlvbi4N
CkBAIC0xNjI1LDggKzE2MjYsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgamJkMl9mcmVlX2lub2Rl
KHN0cnVjdCBqYmQyX2lub2RlICpqaW5vZGUpDQp9DQoNCi8qIFByaW1hcnkgcmV2b2tlIHN1cHBv
cnQgKi8NCi0jZGVmaW5lIEpPVVJOQUxfUkVWT0tFX0RFRkFVTFRfSEFTSCAyNTYNCi1leHRlcm4g
aW50CSAgIGpiZDJfam91cm5hbF9pbml0X3Jldm9rZShqb3VybmFsX3QgKiwgaW50KTsNCitleHRl
cm4gaW50CSAgIGpiZDJfam91cm5hbF9pbml0X3Jldm9rZShqb3VybmFsX3QgKik7DQpleHRlcm4g
dm9pZAkgICBqYmQyX2pvdXJuYWxfZGVzdHJveV9yZXZva2VfcmVjb3JkX2NhY2hlKHZvaWQpOw0K
ZXh0ZXJuIHZvaWQJICAgamJkMl9qb3VybmFsX2Rlc3Ryb3lfcmV2b2tlX3RhYmxlX2NhY2hlKHZv
aWQpOw0KZXh0ZXJuIGludCBfX2luaXQgamJkMl9qb3VybmFsX2luaXRfcmV2b2tlX3JlY29yZF9j
YWNoZSh2b2lkKTsNCi0tIA0KMi4yNi4zDQoNCg0K
